!=========================================================================
! Frame Relay Cloud Configuration (Packet Tracer)
!=========================================================================
! This remains the same as previously discussed and as per your screenshots:
! 1. Cloud Device: Add Serial0, Serial1, Serial2.
! 2. Serial0 (Xentra Router's connection point on the cloud):
!    - DLCI: 102, Name: XentraToHome, Add.
!    - DLCI: 103, Name: XentraToISP, Add.
! 3. Serial1 (Home-Router's connection point on the cloud):
!    - DLCI: 201, Name: HomeToXentra, Add.
!    - DLCI: 203, Name: HomeToISP, Add.
! 4. Serial2 (ISP-Router's connection point on the cloud):
!    - DLCI: 301, Name: ISPToXentra, Add.
!    - DLCI: 302, Name: ISPToHome, Add.
! 5. Frame Relay Mappings in the Cloud:
!    - Serial0 DLCI 102 <--> Serial1 DLCI 201
!    - Serial0 DLCI 103 <--> Serial2 DLCI 301
!    - Serial1 DLCI 203 <--> Serial2 DLCI 302

!=========================================================================
! Xentra Router (hostname: Router) - UPDATED CONFIGURATION
!=========================================================================
enable
configure terminal
hostname Router

! --- Remove old static default route ---
no ip route 0.0.0.0 0.0.0.0 192.168.0.153

! --- Physical Serial Interface Configuration ---
interface Serial0/0/0
 description Physical Link to Frame Relay Cloud (Xentra Port)
 encapsulation frame-relay
 frame-relay lmi-type cisco ! Optional in PT, usually auto-sensed
 no shutdown

! --- Subinterface to Home-Router ---
interface Serial0/0/0.102 point-to-point
 description P2P Link to Home-Router via DLCI 102
 ip address 10.0.1.1 255.255.255.252
 frame-relay interface-dlci 102
 ! OSPF network type will default to point-to-point, which is desired
 no shutdown

! --- Subinterface to ISP-Router ---
interface Serial0/0/0.103 point-to-point
 description P2P Link to ISP-Router via DLCI 103
 ip address 10.0.2.1 255.255.255.252
 frame-relay interface-dlci 103
 no shutdown

! --- Existing GigabitEthernet0/0 Sub-interfaces (Assumed unchanged) ---
interface GigabitEthernet0/0
 no shutdown
interface GigabitEthernet0/0.10
 encapsulation dot1Q 10
 ip address 192.168.0.1 255.255.255.192  
 no shutdown
interface GigabitEthernet0/0.20
 encapsulation dot1Q 20
 ip address 192.168.0.65 255.255.255.192 
 no shutdown
interface GigabitEthernet0/0.30
 encapsulation dot1Q 30
 ip address 192.168.0.129 255.255.255.192
 no shutdown
interface GigabitEthernet0/0.40
 encapsulation dot1Q 40
 ip address 192.168.0.193 255.255.255.192
 no shutdown
interface GigabitEthernet0/0.99
 encapsulation dot1Q 99
 ip address 192.168.0.145 255.255.255.240
 no shutdown

! --- Existing GigabitEthernet0/1 (Old WAN link - keep IP for reachability if needed) ---
interface GigabitEthernet0/1
 description Old WAN link or other segment
 ip address 192.168.0.154 255.255.255.252
 no shutdown

! --- OSPF Configuration ---
router ospf 1
 router-id 1.1.1.1 ! Example router-id, ensure uniqueness
 log-adjacency-changes

 ! Advertise connected networks
 network 10.0.1.0 0.0.0.3 area 0         ! P2P to Home-Router
 network 10.0.2.0 0.0.0.3 area 0         ! P2P to ISP-Router
 network 192.168.0.0 0.0.0.63 area 0     ! VLAN 10 (FLOOR1)
 network 192.168.0.64 0.0.0.63 area 0    ! VLAN 20 (FLOOR2)
 network 192.168.0.128 0.0.0.63 area 0   ! VLAN 30 (FLOOR3)
 network 192.168.0.192 0.0.0.63 area 0   ! VLAN 40 (FLOOR4)
 network 192.168.0.144 0.0.0.15 area 0   ! VLAN 99 (MANAGEMENT)
 network 192.168.0.152 0.0.0.3 area 0    ! Gi0/1 Link (Old WAN)

 ! Make LAN interfaces passive for OSPF
 passive-interface GigabitEthernet0/0.10
 passive-interface GigabitEthernet0/0.20
 passive-interface GigabitEthernet0/0.30
 passive-interface GigabitEthernet0/0.40
 passive-interface GigabitEthernet0/0.99
 ! Consider if Gi0/1 should also be passive or have a specific OSPF network type

! --- DHCP Configuration (Assumed unchanged) ---
ip dhcp excluded-address 192.168.0.1
ip dhcp excluded-address 192.168.0.65  
ip dhcp excluded-address 192.168.0.129 
ip dhcp excluded-address 192.168.0.193 
ip dhcp pool FLOOR1
 network 192.168.0.0 255.255.255.192   
 default-router 192.168.0.1
 dns-server 8.8.8.8
ip dhcp pool FLOOR2
 network 192.168.0.64 255.255.255.192 
 default-router 192.168.0.65          
 dns-server 8.8.8.8
ip dhcp pool FLOOR3
 network 192.168.0.128 255.255.255.192
 default-router 192.168.0.129         
 dns-server 8.8.8.8
ip dhcp pool FLOOR4
 network 192.168.0.192 255.255.255.192
 default-router 192.168.0.193         
 dns-server 8.8.8.8
end
write memory

!=========================================================================
! Home-Router - UPDATED CONFIGURATION
!=========================================================================
enable
configure terminal
hostname Home-Router

! --- Physical Serial Interface Configuration ---
interface Serial0/0/0 ! Assuming Se0/0/0 is used, adjust if different
 description Physical Link to Frame Relay Cloud (Home Port)
 encapsulation frame-relay
 frame-relay lmi-type cisco
 no shutdown

! --- Subinterface to Xentra Router ---
interface Serial0/0/0.201 point-to-point
 description P2P Link to Xentra Router via DLCI 201
 ip address 10.0.1.2 255.255.255.252
 frame-relay interface-dlci 201
 no shutdown

! --- Subinterface to ISP-Router ---
interface Serial0/0/0.203 point-to-point
 description P2P Link to ISP-Router via DLCI 203
 ip address 10.0.3.1 255.255.255.252
 frame-relay interface-dlci 203
 no shutdown

! --- Existing LAN Interface (Assumed unchanged) ---
interface GigabitEthernet0/0
 description Home LAN
 ip address 192.168.254.254 255.255.255.0
 no shutdown

! --- OSPF Configuration ---
router ospf 1
 router-id 2.2.2.2 ! Example router-id, ensure uniqueness
 log-adjacency-changes
 network 10.0.1.0 0.0.0.3 area 0         ! P2P to Xentra Router
 network 10.0.3.0 0.0.0.3 area 0         ! P2P to ISP-Router
 network 192.168.254.0 0.0.0.255 area 0  ! Home LAN
 passive-interface GigabitEthernet0/0    ! Good practice for LAN interfaces
end
write memory

!=========================================================================
! New ISP-Router Configuration - UPDATED
!=========================================================================
enable
configure terminal
hostname ISP-Router

! --- Physical Serial Interface Configuration ---
interface Serial0/0/0 ! Assuming Se0/0/0 is used, adjust if different
 description Physical Link to Frame Relay Cloud (ISP Port)
 encapsulation frame-relay
 frame-relay lmi-type cisco
 no shutdown

! --- Subinterface to Xentra Router ---
interface Serial0/0/0.301 point-to-point
 description P2P Link to Xentra Router via DLCI 301
 ip address 10.0.2.2 255.255.255.252
 frame-relay interface-dlci 301
 no shutdown

! --- Subinterface to Home-Router ---
interface Serial0/0/0.302 point-to-point
 description P2P Link to Home-Router via DLCI 302
 ip address 10.0.3.2 255.255.255.252
 frame-relay interface-dlci 302
 no shutdown

! --- Ethernet Interface Configuration (to Server LAN) ---
interface GigabitEthernet0/0 ! Or whichever port you connect to the server
 description Link to Server LAN
 ip address 172.16.1.1 255.255.255.0
 no shutdown

! --- OSPF Configuration ---
router ospf 1
 router-id 3.3.3.3 ! Example router-id, ensure uniqueness
 log-adjacency-changes
 network 10.0.2.0 0.0.0.3 area 0         ! P2P to Xentra Router
 network 10.0.3.0 0.0.0.3 area 0         ! P2P to Home-Router
 network 172.16.1.0 0.0.0.255 area 0    ! Server LAN
 passive-interface GigabitEthernet0/0    ! Good practice for LAN interfaces
 default-information originate          ! Advertise a default route

! --- Static Default Route (Simulating connection to the Internet) ---
! This helps OSPF's 'default-information originate' have a route to advertise.
! Example for simulation if no "real" upstream:
interface Loopback0
 ip address 203.0.113.1 255.255.255.255 ! A public-like IP
 no shutdown
ip route 0.0.0.0 0.0.0.0 Loopback0
! Or point to the next hop IP of your actual internet connection if applicable.

end
write memory

!=========================================================================
! Server Configuration (Example - Unchanged)
!=========================================================================
! On the Server device:
! IP Address: 172.16.1.10
! Subnet Mask: 255.255.255.0
! Default Gateway: 172.16.1.1 (ISP-Router's Gi0/0 interface)
! DNS Server: (e.g., 8.8.8.8 or an internal DNS if you have one)
